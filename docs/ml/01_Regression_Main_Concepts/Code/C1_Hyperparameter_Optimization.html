<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.41">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Hyperparameter tuning â€“ Python Math &amp; ML Course</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../ml/01_Regression_Main_Concepts/Code/C1_Regression_Main_Concepts.html" rel="prev">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-ba1dc69c819719ff92c66bffe944bb46.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark-45c9daaf6acd34b0420988892e8b8644.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-d0d28e68b2311299fec6095e89651c71.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark-12e5510938fd3d550037282fad4d5003.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../ml/01_Regression_Main_Concepts/Code/C1_Regression_Main_Concepts.html">ML</a></li><li class="breadcrumb-item"><a href="../../../ml/01_Regression_Main_Concepts/Code/C1_Hyperparameter_Optimization.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hyperparameter tuning</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../../">Python Math &amp; ML Course</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/HaykTarkhanyan/python_math_ml_course" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Python &amp; Machine Learning Course</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Math</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../math/pr/pr1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">pr1.html</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../python/Python_01_Intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Ô±Ö€Õ¿Õ¡Õ®Õ¸Ö‚Õ´ (Print(Õ¿ÕºÕ¥Õ¬))</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">ML</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../ml/01_Regression_Main_Concepts/Code/C1_Regression_Main_Concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regression Main Concepts</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../ml/01_Regression_Main_Concepts/Code/C1_Hyperparameter_Optimization.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hyperparameter tuning</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#train-val-test-split" id="toc-train-val-test-split" class="nav-link active" data-scroll-target="#train-val-test-split"><span class="header-section-number">5.1</span> Train Val Test split</a>
  <ul class="collapse">
  <li><a href="#data-prep" id="toc-data-prep" class="nav-link" data-scroll-target="#data-prep"><span class="header-section-number">5.1.1</span> Data Prep</a></li>
  </ul></li>
  <li><a href="#hyperparameter-tuning-with-random-search-and-grid-search" id="toc-hyperparameter-tuning-with-random-search-and-grid-search" class="nav-link" data-scroll-target="#hyperparameter-tuning-with-random-search-and-grid-search"><span class="header-section-number">5.2</span> Hyperparameter Tuning with Random Search and Grid Search</a>
  <ul class="collapse">
  <li><a href="#grid-search" id="toc-grid-search" class="nav-link" data-scroll-target="#grid-search"><span class="header-section-number">5.2.1</span> Grid Search</a></li>
  </ul></li>
  <li><a href="#grid-search-with-sklearn" id="toc-grid-search-with-sklearn" class="nav-link" data-scroll-target="#grid-search-with-sklearn"><span class="header-section-number">5.3</span> Grid Search with sklearn</a></li>
  <li><a href="#random-search" id="toc-random-search" class="nav-link" data-scroll-target="#random-search"><span class="header-section-number">5.4</span> Random Search</a></li>
  <li><a href="#bayesian-optimization" id="toc-bayesian-optimization" class="nav-link" data-scroll-target="#bayesian-optimization"><span class="header-section-number">5.5</span> Bayesian Optimization</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.dev/HaykTarkhanyan/python_math_ml_course/blob/main/ml/01_Regression_Main_Concepts/Code/C1_Hyperparameter_Optimization.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../../ml/01_Regression_Main_Concepts/Code/C1_Regression_Main_Concepts.html">ML</a></li><li class="breadcrumb-item"><a href="../../../ml/01_Regression_Main_Concepts/Code/C1_Hyperparameter_Optimization.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hyperparameter tuning</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Hyperparameter tuning</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="train-val-test-split" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="train-val-test-split"><span class="header-section-number">5.1</span> Train Val Test split</h2>
<p>Role of Each Split 1. <strong>Training Set:</strong> Used to fit or train your model parameters (weights, decision tree splits, etc.). 2. <strong>Validation Set:</strong> Used to tune hyperparameters or compare different models. It provides feedback on how different settings affect performance before touching the test set. 3. <strong>Test Set:</strong> Used <strong>once</strong> at the end to get an unbiased estimate of the final chosen modelâ€™s performance.</p>
<p>The same way we need a dataset separate from the training set to tune hyperparameters, we need a separate dataset to evaluate the modelâ€™s final performance. This is the test set.</p>
<section id="data-prep" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="data-prep"><span class="header-section-number">5.1.1</span> Data Prep</h3>
<div id="cell-4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">"House_Rent_Dataset.csv"</span> <span class="kw">in</span> os.listdir():</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> <span class="st">"House_Rent_Dataset.csv"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> kagglehub</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> kagglehub.dataset_download(<span class="st">"iamsouravbanerjee/house-rent-prediction-dataset"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> os.path.join(path, <span class="st">"House_Rent_Dataset.csv"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(path)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-6" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>target <span class="op">=</span> <span class="st">"Rent"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Split into train val, test</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>train_size <span class="op">=</span> <span class="fl">0.7</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(columns<span class="op">=</span>[target])</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[target]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                                                    train_size<span class="op">=</span>train_size, random_state<span class="op">=</span><span class="dv">5090</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>X_test, X_val, y_test, y_val <span class="op">=</span> train_test_split(X_test, y_test, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                                                  test_size<span class="op">=</span><span class="fl">0.5</span>, random_state<span class="op">=</span><span class="dv">5090</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Sizes: Train=</span><span class="sc">{</span><span class="bu">len</span>(X_train)<span class="sc">}</span><span class="ss">, Val=</span><span class="sc">{</span><span class="bu">len</span>(X_val)<span class="sc">}</span><span class="ss">, Test=</span><span class="sc">{</span><span class="bu">len</span>(X_test)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sizes: Train=3322, Val=712, Test=712</code></pre>
</div>
</div>
<p>Note: It would have been better to do cross-validation here</p>
<div id="cell-8" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>COLS_TO_DROP <span class="op">=</span> [<span class="st">"Posted On"</span>, <span class="st">"Floor"</span>, <span class="st">"Area Locality"</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> basic_preprocessing(df):</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.drop(columns<span class="op">=</span>COLS_TO_DROP)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    df.rename(columns<span class="op">=</span>{<span class="st">"Furnishing Status"</span>: <span class="st">"Furnish"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-9" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> basic_preprocessing(X_train)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>X_val <span class="op">=</span> basic_preprocessing(X_val)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> basic_preprocessing(X_test)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>X_val</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">BHK</th>
<th data-quarto-table-cell-role="th">Size</th>
<th data-quarto-table-cell-role="th">Area Type</th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">Furnish</th>
<th data-quarto-table-cell-role="th">Tenant Preferred</th>
<th data-quarto-table-cell-role="th">Bathroom</th>
<th data-quarto-table-cell-role="th">Point of Contact</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">284</td>
<td>2</td>
<td>900</td>
<td>Super Area</td>
<td>Kolkata</td>
<td>Unfurnished</td>
<td>Bachelors/Family</td>
<td>1</td>
<td>Contact Owner</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">257</td>
<td>2</td>
<td>450</td>
<td>Carpet Area</td>
<td>Kolkata</td>
<td>Unfurnished</td>
<td>Bachelors</td>
<td>1</td>
<td>Contact Owner</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">872</td>
<td>2</td>
<td>400</td>
<td>Carpet Area</td>
<td>Mumbai</td>
<td>Furnished</td>
<td>Bachelors/Family</td>
<td>1</td>
<td>Contact Owner</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3749</td>
<td>3</td>
<td>1610</td>
<td>Super Area</td>
<td>Chennai</td>
<td>Semi-Furnished</td>
<td>Family</td>
<td>3</td>
<td>Contact Agent</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2732</td>
<td>2</td>
<td>1000</td>
<td>Super Area</td>
<td>Delhi</td>
<td>Semi-Furnished</td>
<td>Family</td>
<td>1</td>
<td>Contact Owner</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2357</td>
<td>2</td>
<td>850</td>
<td>Super Area</td>
<td>Bangalore</td>
<td>Semi-Furnished</td>
<td>Bachelors/Family</td>
<td>2</td>
<td>Contact Owner</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3842</td>
<td>2</td>
<td>1000</td>
<td>Carpet Area</td>
<td>Chennai</td>
<td>Unfurnished</td>
<td>Bachelors</td>
<td>2</td>
<td>Contact Owner</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1799</td>
<td>1</td>
<td>500</td>
<td>Super Area</td>
<td>Bangalore</td>
<td>Unfurnished</td>
<td>Bachelors/Family</td>
<td>1</td>
<td>Contact Owner</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3931</td>
<td>2</td>
<td>1800</td>
<td>Super Area</td>
<td>Hyderabad</td>
<td>Furnished</td>
<td>Bachelors/Family</td>
<td>2</td>
<td>Contact Owner</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1137</td>
<td>1</td>
<td>380</td>
<td>Carpet Area</td>
<td>Mumbai</td>
<td>Unfurnished</td>
<td>Bachelors/Family</td>
<td>2</td>
<td>Contact Agent</td>
</tr>
</tbody>
</table>

<p>712 rows Ã— 8 columns</p>
</div>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>COLS_OHE <span class="op">=</span> [<span class="st">"City"</span>]</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>COLS_ORDINAL <span class="op">=</span> [<span class="st">"Furnish"</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>COLS_STANDARD_SCALE <span class="op">=</span> [<span class="st">"BHK"</span>, <span class="st">"Bathroom"</span>, <span class="st">"Size"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-11" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder, OrdinalEncoder, StandardScaler, <span class="op">\</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    PolynomialFeatures</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ohe <span class="op">=</span> OneHotEncoder(sparse_output<span class="op">=</span><span class="va">False</span>, handle_unknown<span class="op">=</span><span class="st">"ignore"</span>, drop<span class="op">=</span><span class="st">"first"</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>ordinal <span class="op">=</span> OrdinalEncoder(categories<span class="op">=</span>[[<span class="st">"Unfurnished"</span>, <span class="st">"Semi-Furnished"</span>, <span class="st">"Furnished"</span>]])</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>standard <span class="op">=</span> StandardScaler()</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>poly <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>FIT ONLY ON TRAIN, OTHERWISE DATA LEAKAGE</p>
<div id="cell-13" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ohe.fit(X_train[COLS_OHE])</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ordinal.fit(X_train[COLS_ORDINAL])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>poly.fit(X_train[COLS_STANDARD_SCALE])</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>X_train_poly <span class="op">=</span> poly.transform(X_train[COLS_STANDARD_SCALE])</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>standard.fit(X_train_poly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "â–¸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "â–¾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>StandardScaler()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;StandardScaler<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.preprocessing.StandardScaler.html">?<span>Documentation for StandardScaler</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>StandardScaler()</pre></div> </div></div></div></div>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> preprocess_data(X, ohe, ordinal, standard):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    X_ohe <span class="op">=</span> ohe.transform(X[COLS_OHE])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    X_ordinal <span class="op">=</span> ordinal.transform(X[COLS_ORDINAL])</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    x_poly <span class="op">=</span> poly.transform(X[COLS_STANDARD_SCALE])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    X_poly_standard <span class="op">=</span> standard.transform(x_poly)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    X_poly_standard <span class="op">=</span> pd.DataFrame(X_poly_standard, columns<span class="op">=</span>poly.get_feature_names_out())</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    X_ohe <span class="op">=</span> pd.DataFrame(X_ohe, columns<span class="op">=</span>ohe.get_feature_names_out(COLS_OHE))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    X_ordinal <span class="op">=</span> pd.DataFrame(X_ordinal, columns<span class="op">=</span>COLS_ORDINAL)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    X_poly_standard <span class="op">=</span> pd.DataFrame(X_poly_standard, columns<span class="op">=</span>poly.get_feature_names_out(COLS_STANDARD_SCALE))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> pd.concat([X_poly_standard, X_ohe, X_ordinal], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-15" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> preprocess_data(X_train, ohe, ordinal, standard)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>X_val <span class="op">=</span> preprocess_data(X_val, ohe, ordinal, standard)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> preprocess_data(X_test, ohe, ordinal, standard)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>X_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">BHK</th>
<th data-quarto-table-cell-role="th">Bathroom</th>
<th data-quarto-table-cell-role="th">Size</th>
<th data-quarto-table-cell-role="th">BHK^2</th>
<th data-quarto-table-cell-role="th">BHK Bathroom</th>
<th data-quarto-table-cell-role="th">BHK Size</th>
<th data-quarto-table-cell-role="th">Bathroom^2</th>
<th data-quarto-table-cell-role="th">Bathroom Size</th>
<th data-quarto-table-cell-role="th">Size^2</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">Bathroom^3</th>
<th data-quarto-table-cell-role="th">Bathroom^2 Size</th>
<th data-quarto-table-cell-role="th">Bathroom Size^2</th>
<th data-quarto-table-cell-role="th">Size^3</th>
<th data-quarto-table-cell-role="th">City_Chennai</th>
<th data-quarto-table-cell-role="th">City_Delhi</th>
<th data-quarto-table-cell-role="th">City_Hyderabad</th>
<th data-quarto-table-cell-role="th">City_Kolkata</th>
<th data-quarto-table-cell-role="th">City_Mumbai</th>
<th data-quarto-table-cell-role="th">Furnish</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.0</td>
<td>1.110492</td>
<td>1.189251</td>
<td>0.829344</td>
<td>0.999475</td>
<td>1.114653</td>
<td>0.806053</td>
<td>0.928818</td>
<td>0.707418</td>
<td>0.344902</td>
<td>...</td>
<td>0.506051</td>
<td>0.356248</td>
<td>0.175618</td>
<td>0.041691</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.0</td>
<td>-0.097846</td>
<td>-1.091749</td>
<td>-0.563145</td>
<td>-0.254682</td>
<td>-0.677640</td>
<td>-0.450178</td>
<td>-0.759804</td>
<td>-0.549198</td>
<td>-0.376971</td>
<td>...</td>
<td>-0.427136</td>
<td>-0.317066</td>
<td>-0.237390</td>
<td>-0.183322</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.0</td>
<td>-0.097846</td>
<td>0.048751</td>
<td>-0.408424</td>
<td>-0.254682</td>
<td>-0.165556</td>
<td>-0.374043</td>
<td>-0.126570</td>
<td>-0.291431</td>
<td>-0.327319</td>
<td>...</td>
<td>-0.175894</td>
<td>-0.202237</td>
<td>-0.197317</td>
<td>-0.174276</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.0</td>
<td>-0.097846</td>
<td>0.048751</td>
<td>0.133100</td>
<td>-0.254682</td>
<td>-0.165556</td>
<td>-0.107570</td>
<td>-0.126570</td>
<td>-0.065884</td>
<td>-0.093378</td>
<td>...</td>
<td>-0.175894</td>
<td>-0.129164</td>
<td>-0.118141</td>
<td>-0.116251</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.0</td>
<td>-0.097846</td>
<td>-1.091749</td>
<td>-0.021621</td>
<td>-0.254682</td>
<td>-0.677640</td>
<td>-0.183705</td>
<td>-0.759804</td>
<td>-0.436425</td>
<td>-0.169767</td>
<td>...</td>
<td>-0.427136</td>
<td>-0.298798</td>
<td>-0.202326</td>
<td>-0.137638</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3317</td>
<td>0.0</td>
<td>-0.097846</td>
<td>0.048751</td>
<td>0.055739</td>
<td>-0.254682</td>
<td>-0.165556</td>
<td>-0.145637</td>
<td>-0.126570</td>
<td>-0.098105</td>
<td>-0.132528</td>
<td>...</td>
<td>-0.175894</td>
<td>-0.139603</td>
<td>-0.131391</td>
<td>-0.127479</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3318</td>
<td>0.0</td>
<td>-1.306183</td>
<td>-1.091749</td>
<td>-0.795227</td>
<td>-1.007177</td>
<td>-0.933682</td>
<td>-0.735686</td>
<td>-0.759804</td>
<td>-0.597530</td>
<td>-0.437127</td>
<td>...</td>
<td>-0.427136</td>
<td>-0.324895</td>
<td>-0.247570</td>
<td>-0.192217</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3319</td>
<td>0.0</td>
<td>-0.097846</td>
<td>0.048751</td>
<td>0.055739</td>
<td>-0.254682</td>
<td>-0.165556</td>
<td>-0.145637</td>
<td>-0.126570</td>
<td>-0.098105</td>
<td>-0.132528</td>
<td>...</td>
<td>-0.175894</td>
<td>-0.139603</td>
<td>-0.131391</td>
<td>-0.127479</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3320</td>
<td>0.0</td>
<td>-1.306183</td>
<td>0.048751</td>
<td>-0.717866</td>
<td>-1.007177</td>
<td>-0.677640</td>
<td>-0.716652</td>
<td>-0.126570</td>
<td>-0.420314</td>
<td>-0.418985</td>
<td>...</td>
<td>-0.175894</td>
<td>-0.243993</td>
<td>-0.228341</td>
<td>-0.189804</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>2.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3321</td>
<td>0.0</td>
<td>1.110492</td>
<td>1.189251</td>
<td>1.602950</td>
<td>0.999475</td>
<td>1.114653</td>
<td>1.377068</td>
<td>0.928818</td>
<td>1.190732</td>
<td>1.013303</td>
<td>...</td>
<td>0.506051</td>
<td>0.591125</td>
<td>0.514943</td>
<td>0.371127</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
</tbody>
</table>

<p>3322 rows Ã— 26 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="hyperparameter-tuning-with-random-search-and-grid-search" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="hyperparameter-tuning-with-random-search-and-grid-search"><span class="header-section-number">5.2</span> Hyperparameter Tuning with Random Search and Grid Search</h2>
<div id="cell-17" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> RandomizedSearchCV, GridSearchCV</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ConvergenceWarning</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ignore the warning</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># from warnings import simplefilter</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co"># simplefilter("ignore")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notes: - confusing terminology, the regularization parameter is called alpha in sklearn - lambda (alpha) is usually searched on a log scale</p>
<div id="cell-19" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.logspace(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">20</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alphas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[  10.           12.74274986   16.23776739   20.69138081   26.36650899
   33.59818286   42.81332399   54.55594781   69.51927962   88.58667904
  112.88378917  143.84498883  183.29807108  233.57214691  297.63514416
  379.26901907  483.29302386  615.84821107  784.75997035 1000.        ]</code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span> <span class="op">**</span> <span class="op">-</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>0.1</code></pre>
</div>
</div>
<section id="grid-search" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="grid-search"><span class="header-section-number">5.2.1</span> Grid Search</h3>
<div id="cell-22" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extend the grid </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"alpha"</span>: [<span class="dv">10</span> <span class="op">**</span> i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>)],</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_iter'</span>: [<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">50_000</span>]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># get Decartian product of all the hyperparameters</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>param_grid</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>{'alpha': [0.001, 0.01, 0.1, 1, 10, 100, 1000], 'max_iter': [10, 100, 50000]}</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>res_list <span class="op">=</span> []</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> lamb <span class="kw">in</span> param_grid[<span class="st">'alpha'</span>]:</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> max_iter <span class="kw">in</span> param_grid[<span class="st">'max_iter'</span>]:</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> Lasso(alpha<span class="op">=</span>lamb, max_iter<span class="op">=</span>max_iter)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        model.fit(X_train, y_train)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        y_pred_train <span class="op">=</span> model.predict(X_train)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        y_pred_val <span class="op">=</span> model.predict(X_val)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># r2</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        r2_train <span class="op">=</span> model.score(X_train, y_train)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        r2_val <span class="op">=</span> model.score(X_val, y_val)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> {</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"lambda"</span>: lamb,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_iter"</span>: max_iter,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"r2_train"</span>: r2_train,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>            <span class="st">"r2_val"</span>: r2_val</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(res)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>        res_list.append(res)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>        </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{'lambda': 0.001, 'max_iter': 10, 'r2_train': 0.286300900903835, 'r2_val': 0.5469368390683846}
{'lambda': 0.001, 'max_iter': 100, 'r2_train': 0.2957594907787815, 'r2_val': 0.5626080457488305}
{'lambda': 0.001, 'max_iter': 50000, 'r2_train': 0.30240718968076064, 'r2_val': 0.5734121131426642}
{'lambda': 0.01, 'max_iter': 10, 'r2_train': 0.28630087985195296, 'r2_val': 0.5469369298770144}
{'lambda': 0.01, 'max_iter': 100, 'r2_train': 0.2957593913671396, 'r2_val': 0.5626080842528678}
{'lambda': 0.01, 'max_iter': 50000, 'r2_train': 0.3024071886295646, 'r2_val': 0.5734129905395922}
{'lambda': 0.1, 'max_iter': 10, 'r2_train': 0.28630066925527053, 'r2_val': 0.546937837867848}
{'lambda': 0.1, 'max_iter': 100, 'r2_train': 0.29575839666805526, 'r2_val': 0.5626084686353577}
{'lambda': 0.1, 'max_iter': 50000, 'r2_train': 0.3024070457697213, 'r2_val': 0.5734215832461952}
{'lambda': 1, 'max_iter': 10, 'r2_train': 0.2862985555024221, 'r2_val': 0.546946908229855}
{'lambda': 1, 'max_iter': 100, 'r2_train': 0.29574839141060527, 'r2_val': 0.5626122466719441}
{'lambda': 1, 'max_iter': 50000, 'r2_train': 0.3023958904596029, 'r2_val': 0.5734382202362194}
{'lambda': 10, 'max_iter': 10, 'r2_train': 0.2862759984679407, 'r2_val': 0.5470263966801132}
{'lambda': 10, 'max_iter': 100, 'r2_train': 0.2956438812251351, 'r2_val': 0.5626463119101777}
{'lambda': 10, 'max_iter': 50000, 'r2_train': 0.3019441918919157, 'r2_val': 0.5716460477070587}
{'lambda': 100, 'max_iter': 10, 'r2_train': 0.2859912802103456, 'r2_val': 0.5478256953197767}
{'lambda': 100, 'max_iter': 100, 'r2_train': 0.29462512075138036, 'r2_val': 0.5636114381784972}
{'lambda': 100, 'max_iter': 50000, 'r2_train': 0.29711504164066593, 'r2_val': 0.5664434496196209}
{'lambda': 1000, 'max_iter': 10, 'r2_train': 0.2822369767509024, 'r2_val': 0.5519400187789713}
{'lambda': 1000, 'max_iter': 100, 'r2_train': 0.2826332175940921, 'r2_val': 0.555507368159095}
{'lambda': 1000, 'max_iter': 50000, 'r2_train': 0.28265746301940353, 'r2_val': 0.5563976587973434}</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>res_df <span class="op">=</span> pd.DataFrame(res_list)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>res_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">lambda</th>
<th data-quarto-table-cell-role="th">max_iter</th>
<th data-quarto-table-cell-role="th">r2_train</th>
<th data-quarto-table-cell-role="th">r2_val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.001</td>
<td>10</td>
<td>0.286301</td>
<td>0.546937</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.001</td>
<td>100</td>
<td>0.295759</td>
<td>0.562608</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.001</td>
<td>50000</td>
<td>0.302407</td>
<td>0.573412</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.010</td>
<td>10</td>
<td>0.286301</td>
<td>0.546937</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.010</td>
<td>100</td>
<td>0.295759</td>
<td>0.562608</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>0.010</td>
<td>50000</td>
<td>0.302407</td>
<td>0.573413</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>0.100</td>
<td>10</td>
<td>0.286301</td>
<td>0.546938</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>0.100</td>
<td>100</td>
<td>0.295758</td>
<td>0.562608</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>0.100</td>
<td>50000</td>
<td>0.302407</td>
<td>0.573422</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>1.000</td>
<td>10</td>
<td>0.286299</td>
<td>0.546947</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10</td>
<td>1.000</td>
<td>100</td>
<td>0.295748</td>
<td>0.562612</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>1.000</td>
<td>50000</td>
<td>0.302396</td>
<td>0.573438</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>10.000</td>
<td>10</td>
<td>0.286276</td>
<td>0.547026</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13</td>
<td>10.000</td>
<td>100</td>
<td>0.295644</td>
<td>0.562646</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>10.000</td>
<td>50000</td>
<td>0.301944</td>
<td>0.571646</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15</td>
<td>100.000</td>
<td>10</td>
<td>0.285991</td>
<td>0.547826</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>100.000</td>
<td>100</td>
<td>0.294625</td>
<td>0.563611</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>100.000</td>
<td>50000</td>
<td>0.297115</td>
<td>0.566443</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">18</td>
<td>1000.000</td>
<td>10</td>
<td>0.282237</td>
<td>0.551940</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19</td>
<td>1000.000</td>
<td>100</td>
<td>0.282633</td>
<td>0.555507</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20</td>
<td>1000.000</td>
<td>50000</td>
<td>0.282657</td>
<td>0.556398</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-25" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>px.scatter(res_df, x<span class="op">=</span><span class="st">"lambda"</span>, y<span class="op">=</span><span class="st">"max_iter"</span>, log_x<span class="op">=</span><span class="va">True</span>, log_y<span class="op">=</span><span class="va">True</span>, color<span class="op">=</span><span class="st">"r2_val"</span>, title<span class="op">=</span><span class="st">"Grid Search"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>
</section>
</section>
<section id="grid-search-with-sklearn" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="grid-search-with-sklearn"><span class="header-section-number">5.3</span> Grid Search with sklearn</h2>
<div id="cell-27" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>param_grid <span class="op">=</span> {</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"alpha"</span>: [<span class="dv">10</span> <span class="op">**</span> i <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">2</span>)],</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_iter'</span>: [<span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">50_000</span>], </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'tol'</span>: [<span class="fl">1e-4</span>,  <span class="fl">1e-2</span>],</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fit_intercept"</span>: [<span class="va">True</span>, <span class="va">False</span>]  </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-28" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>grid_search <span class="op">=</span> GridSearchCV(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>    estimator<span class="op">=</span>Lasso(),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    param_grid<span class="op">=</span>param_grid,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    scoring<span class="op">=</span><span class="st">'r2'</span>,       <span class="co"># Optimize R^2</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">3</span>,               <span class="co"># 5-fold cross-validation</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span>,          <span class="co"># Use all CPU cores</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="va">True</span>        <span class="co"># Print more information  </span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>X_use <span class="op">=</span> pd.concat([X_train, X_val]).head(<span class="dv">1_000</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>y_use <span class="op">=</span> pd.concat([y_train, y_val]).head(<span class="dv">1_000</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>grid_search.fit(X_use, y_use)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 3 folds for each of 60 candidates, totalling 180 fits</code></pre>
</div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg ansi-bold">KeyboardInterrupt</span>                         Traceback (most recent call last)
Input <span class="ansi-green-fg ansi-bold">In [22]</span>, in <span class="ansi-cyan-fg">&lt;cell line: 13&gt;</span><span class="ansi-blue-fg ansi-bold">()</span>
<span class="ansi-green-fg">     10</span> X_use <span style="color:rgb(98,98,98)">=</span> pd<span style="color:rgb(98,98,98)">.</span>concat([X_train, X_val])<span style="color:rgb(98,98,98)">.</span>head(<span style="color:rgb(98,98,98)">1_000</span>)
<span class="ansi-green-fg">     11</span> y_use <span style="color:rgb(98,98,98)">=</span> pd<span style="color:rgb(98,98,98)">.</span>concat([y_train, y_val])<span style="color:rgb(98,98,98)">.</span>head(<span style="color:rgb(98,98,98)">1_000</span>)
<span class="ansi-green-fg ansi-bold">---&gt; 13</span> <span class="ansi-yellow-bg">grid_search</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X_use</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y_use</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg ansi-bold">c:\Users\hayk_\.conda\envs\thesis\lib\site-packages\sklearn\base.py:1473</span>, in <span class="ansi-cyan-fg">_fit_context.&lt;locals&gt;.decorator.&lt;locals&gt;.wrapper</span><span class="ansi-blue-fg ansi-bold">(estimator, *args, **kwargs)</span>
<span class="ansi-green-fg">   1466</span>     estimator<span style="color:rgb(98,98,98)">.</span>_validate_params()
<span class="ansi-green-fg">   1468</span> <span style="font-weight:bold;color:rgb(0,135,0)">with</span> config_context(
<span class="ansi-green-fg">   1469</span>     skip_parameter_validation<span style="color:rgb(98,98,98)">=</span>(
<span class="ansi-green-fg">   1470</span>         prefer_skip_nested_validation <span style="font-weight:bold;color:rgb(175,0,255)">or</span> global_skip_validation
<span class="ansi-green-fg">   1471</span>     )
<span class="ansi-green-fg">   1472</span> ):
<span class="ansi-green-fg ansi-bold">-&gt; 1473</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> fit_method(estimator, <span style="color:rgb(98,98,98)">*</span>args, <span style="color:rgb(98,98,98)">*</span><span style="color:rgb(98,98,98)">*</span>kwargs)

File <span class="ansi-green-fg ansi-bold">c:\Users\hayk_\.conda\envs\thesis\lib\site-packages\sklearn\model_selection\_search.py:1019</span>, in <span class="ansi-cyan-fg">BaseSearchCV.fit</span><span class="ansi-blue-fg ansi-bold">(self, X, y, **params)</span>
<span class="ansi-green-fg">   1013</span>     results <span style="color:rgb(98,98,98)">=</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_format_results(
<span class="ansi-green-fg">   1014</span>         all_candidate_params, n_splits, all_out, all_more_results
<span class="ansi-green-fg">   1015</span>     )
<span class="ansi-green-fg">   1017</span>     <span style="font-weight:bold;color:rgb(0,135,0)">return</span> results
<span class="ansi-green-fg ansi-bold">-&gt; 1019</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_run_search</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">evaluate_candidates</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">   1021</span> <span style="font-style:italic;color:rgb(95,135,135)"># multimetric is determined here because in the case of a callable</span>
<span class="ansi-green-fg">   1022</span> <span style="font-style:italic;color:rgb(95,135,135)"># self.scoring the return type is only known after calling</span>
<span class="ansi-green-fg">   1023</span> first_test_score <span style="color:rgb(98,98,98)">=</span> all_out[<span style="color:rgb(98,98,98)">0</span>][<span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">test_scores</span><span style="color:rgb(175,0,0)">"</span>]

File <span class="ansi-green-fg ansi-bold">c:\Users\hayk_\.conda\envs\thesis\lib\site-packages\sklearn\model_selection\_search.py:1573</span>, in <span class="ansi-cyan-fg">GridSearchCV._run_search</span><span class="ansi-blue-fg ansi-bold">(self, evaluate_candidates)</span>
<span class="ansi-green-fg">   1571</span> <span style="font-weight:bold;color:rgb(0,135,0)">def</span> <span style="color:rgb(0,0,255)">_run_search</span>(<span style="color:rgb(0,135,0)">self</span>, evaluate_candidates):
<span class="ansi-green-fg">   1572</span> <span style="color:rgb(188,188,188)">    </span><span style="font-style:italic;color:rgb(175,0,0)">"""Search all candidates in param_grid"""</span>
<span class="ansi-green-fg ansi-bold">-&gt; 1573</span>     <span class="ansi-yellow-bg">evaluate_candidates</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">ParameterGrid</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">self</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">param_grid</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg ansi-bold">c:\Users\hayk_\.conda\envs\thesis\lib\site-packages\sklearn\model_selection\_search.py:965</span>, in <span class="ansi-cyan-fg">BaseSearchCV.fit.&lt;locals&gt;.evaluate_candidates</span><span class="ansi-blue-fg ansi-bold">(candidate_params, cv, more_results)</span>
<span class="ansi-green-fg">    957</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>verbose <span style="color:rgb(98,98,98)">&gt;</span> <span style="color:rgb(98,98,98)">0</span>:
<span class="ansi-green-fg">    958</span>     <span style="color:rgb(0,135,0)">print</span>(
<span class="ansi-green-fg">    959</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Fitting </span><span style="font-weight:bold;color:rgb(175,95,135)">{0}</span><span style="color:rgb(175,0,0)"> folds for each of </span><span style="font-weight:bold;color:rgb(175,95,135)">{1}</span><span style="color:rgb(175,0,0)"> candidates,</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg">    960</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)"> totalling </span><span style="font-weight:bold;color:rgb(175,95,135)">{2}</span><span style="color:rgb(175,0,0)"> fits</span><span style="color:rgb(175,0,0)">"</span><span style="color:rgb(98,98,98)">.</span>format(
<span class="ansi-green-fg">    961</span>             n_splits, n_candidates, n_candidates <span style="color:rgb(98,98,98)">*</span> n_splits
<span class="ansi-green-fg">    962</span>         )
<span class="ansi-green-fg">    963</span>     )
<span class="ansi-green-fg ansi-bold">--&gt; 965</span> out <span style="color:rgb(98,98,98)">=</span> <span class="ansi-yellow-bg">parallel</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">    966</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">delayed</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">_fit_and_score</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">    967</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">clone</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">base_estimator</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    968</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    969</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    970</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">train</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">train</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    971</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">test</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">test</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    972</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">parameters</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">parameters</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    973</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">split_progress</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">split_idx</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">n_splits</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    974</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg">candidate_progress</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">cand_idx</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">n_candidates</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    975</span> <span class="ansi-yellow-bg">        </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">fit_and_score_kwargs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    976</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    977</span> <span class="ansi-yellow-bg">    </span><span style="font-weight:bold;color:rgb(0,135,0)" class="ansi-yellow-bg">for</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">cand_idx</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">parameters</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">split_idx</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">train</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">test</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg"> </span><span style="font-weight:bold;color:rgb(175,0,255)" class="ansi-yellow-bg">in</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">product</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">    978</span> <span class="ansi-yellow-bg">        </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">enumerate</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">candidate_params</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    979</span> <span class="ansi-yellow-bg">        </span><span style="color:rgb(0,135,0)" class="ansi-yellow-bg">enumerate</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">cv</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">split</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">routed_params</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">splitter</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">split</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    980</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    981</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    983</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">len</span>(out) <span style="color:rgb(98,98,98)">&lt;</span> <span style="color:rgb(98,98,98)">1</span>:
<span class="ansi-green-fg">    984</span>     <span style="font-weight:bold;color:rgb(0,135,0)">raise</span> <span style="font-weight:bold;color:rgb(215,95,95)">ValueError</span>(
<span class="ansi-green-fg">    985</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">No fits were performed. </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg">    986</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Was the CV iterator empty? </span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg">    987</span>         <span style="color:rgb(175,0,0)">"</span><span style="color:rgb(175,0,0)">Were there no candidates?</span><span style="color:rgb(175,0,0)">"</span>
<span class="ansi-green-fg">    988</span>     )

File <span class="ansi-green-fg ansi-bold">c:\Users\hayk_\.conda\envs\thesis\lib\site-packages\sklearn\utils\parallel.py:74</span>, in <span class="ansi-cyan-fg">Parallel.__call__</span><span class="ansi-blue-fg ansi-bold">(self, iterable)</span>
<span class="ansi-green-fg">     69</span> config <span style="color:rgb(98,98,98)">=</span> get_config()
<span class="ansi-green-fg">     70</span> iterable_with_config <span style="color:rgb(98,98,98)">=</span> (
<span class="ansi-green-fg">     71</span>     (_with_config(delayed_func, config), args, kwargs)
<span class="ansi-green-fg">     72</span>     <span style="font-weight:bold;color:rgb(0,135,0)">for</span> delayed_func, args, kwargs <span style="font-weight:bold;color:rgb(175,0,255)">in</span> iterable
<span class="ansi-green-fg">     73</span> )
<span class="ansi-green-fg ansi-bold">---&gt; 74</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">super</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">)</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span style="color:rgb(0,0,255)" class="ansi-yellow-bg">__call__</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">iterable_with_config</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg ansi-bold">c:\Users\hayk_\.conda\envs\thesis\lib\site-packages\joblib\parallel.py:2007</span>, in <span class="ansi-cyan-fg">Parallel.__call__</span><span class="ansi-blue-fg ansi-bold">(self, iterable)</span>
<span class="ansi-green-fg">   2001</span> <span style="font-style:italic;color:rgb(95,135,135)"># The first item from the output is blank, but it makes the interpreter</span>
<span class="ansi-green-fg">   2002</span> <span style="font-style:italic;color:rgb(95,135,135)"># progress until it enters the Try/Except block of the generator and</span>
<span class="ansi-green-fg">   2003</span> <span style="font-style:italic;color:rgb(95,135,135)"># reach the first `yield` statement. This starts the aynchronous</span>
<span class="ansi-green-fg">   2004</span> <span style="font-style:italic;color:rgb(95,135,135)"># dispatch of the tasks to the workers.</span>
<span class="ansi-green-fg">   2005</span> <span style="color:rgb(0,135,0)">next</span>(output)
<span class="ansi-green-fg ansi-bold">-&gt; 2007</span> <span style="font-weight:bold;color:rgb(0,135,0)">return</span> output <span style="font-weight:bold;color:rgb(0,135,0)">if</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>return_generator <span style="font-weight:bold;color:rgb(0,135,0)">else</span> <span style="color:rgb(0,135,0)" class="ansi-yellow-bg">list</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">output</span><span class="ansi-yellow-bg">)</span>

File <span class="ansi-green-fg ansi-bold">c:\Users\hayk_\.conda\envs\thesis\lib\site-packages\joblib\parallel.py:1650</span>, in <span class="ansi-cyan-fg">Parallel._get_outputs</span><span class="ansi-blue-fg ansi-bold">(self, iterator, pre_dispatch)</span>
<span class="ansi-green-fg">   1647</span>     <span style="font-weight:bold;color:rgb(0,135,0)">yield</span>
<span class="ansi-green-fg">   1649</span>     <span style="font-weight:bold;color:rgb(0,135,0)">with</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_backend<span style="color:rgb(98,98,98)">.</span>retrieval_context():
<span class="ansi-green-fg ansi-bold">-&gt; 1650</span>         <span style="font-weight:bold;color:rgb(0,135,0)">yield from</span> <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_retrieve()
<span class="ansi-green-fg">   1652</span> <span style="font-weight:bold;color:rgb(0,135,0)">except</span> <span style="font-weight:bold;color:rgb(215,95,95)">GeneratorExit</span>:
<span class="ansi-green-fg">   1653</span>     <span style="font-style:italic;color:rgb(95,135,135)"># The generator has been garbage collected before being fully</span>
<span class="ansi-green-fg">   1654</span>     <span style="font-style:italic;color:rgb(95,135,135)"># consumed. This aborts the remaining tasks if possible and warn</span>
<span class="ansi-green-fg">   1655</span>     <span style="font-style:italic;color:rgb(95,135,135)"># the user if necessary.</span>
<span class="ansi-green-fg">   1656</span>     <span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_exception <span style="color:rgb(98,98,98)">=</span> <span style="font-weight:bold;color:rgb(0,135,0)">True</span>

File <span class="ansi-green-fg ansi-bold">c:\Users\hayk_\.conda\envs\thesis\lib\site-packages\joblib\parallel.py:1762</span>, in <span class="ansi-cyan-fg">Parallel._retrieve</span><span class="ansi-blue-fg ansi-bold">(self)</span>
<span class="ansi-green-fg">   1757</span> <span style="font-style:italic;color:rgb(95,135,135)"># If the next job is not ready for retrieval yet, we just wait for</span>
<span class="ansi-green-fg">   1758</span> <span style="font-style:italic;color:rgb(95,135,135)"># async callbacks to progress.</span>
<span class="ansi-green-fg">   1759</span> <span style="font-weight:bold;color:rgb(0,135,0)">if</span> ((<span style="color:rgb(0,135,0)">len</span>(<span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_jobs) <span style="color:rgb(98,98,98)">==</span> <span style="color:rgb(98,98,98)">0</span>) <span style="font-weight:bold;color:rgb(175,0,255)">or</span>
<span class="ansi-green-fg">   1760</span>     (<span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>_jobs[<span style="color:rgb(98,98,98)">0</span>]<span style="color:rgb(98,98,98)">.</span>get_status(
<span class="ansi-green-fg">   1761</span>         timeout<span style="color:rgb(98,98,98)">=</span><span style="color:rgb(0,135,0)">self</span><span style="color:rgb(98,98,98)">.</span>timeout) <span style="color:rgb(98,98,98)">==</span> TASK_PENDING)):
<span class="ansi-green-fg ansi-bold">-&gt; 1762</span>     <span class="ansi-yellow-bg">time</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">sleep</span><span class="ansi-yellow-bg">(</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">0.01</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">   1763</span>     <span style="font-weight:bold;color:rgb(0,135,0)">continue</span>
<span class="ansi-green-fg">   1765</span> <span style="font-style:italic;color:rgb(95,135,135)"># We need to be careful: the job list can be filling up as</span>
<span class="ansi-green-fg">   1766</span> <span style="font-style:italic;color:rgb(95,135,135)"># we empty it and Python list are not thread-safe by</span>
<span class="ansi-green-fg">   1767</span> <span style="font-style:italic;color:rgb(95,135,135)"># default hence the use of the lock</span>

<span class="ansi-red-fg ansi-bold">KeyboardInterrupt</span>: </pre>
</div>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">== Grid Search Results =="</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best parameters found:"</span>, grid_search.best_params_)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best cross-validation R^2:"</span>, grid_search.best_score_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
== Grid Search Results ==
Best parameters found: {'alpha': 10, 'fit_intercept': True, 'max_iter': 50000, 'tol': 0.01}
Best cross-validation R^2: 0.5424913981816509</code></pre>
</div>
</div>
<div id="cell-30" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score, root_mean_squared_error</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>best_lasso <span class="op">=</span> grid_search.best_estimator_</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>y_train_pred <span class="op">=</span> best_lasso.predict(X_train)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>y_val_pred <span class="op">=</span> best_lasso.predict(X_val)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>y_test_pred <span class="op">=</span> best_lasso.predict(X_test)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_model(y_true, y_pred):</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    mse <span class="op">=</span> root_mean_squared_error(y_true, y_pred)</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    r2 <span class="op">=</span> r2_score(y_true, y_pred)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mse, r2</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>mse_train, r2_train <span class="op">=</span> evaluate_model(y_train, y_train_pred)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>mse_val, r2_val <span class="op">=</span> evaluate_model(y_val, y_val_pred)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>mse_test, r2_test <span class="op">=</span> evaluate_model(y_test, y_test_pred)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Train: RMSE=</span><span class="sc">{</span>mse_train<span class="sc">:.2f}</span><span class="ss">, R^2=</span><span class="sc">{</span>r2_train<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Val: RMSE=</span><span class="sc">{</span>mse_val<span class="sc">:.2f}</span><span class="ss">, R^2=</span><span class="sc">{</span>r2_val<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test: RMSE=</span><span class="sc">{</span>mse_test<span class="sc">:.2f}</span><span class="ss">, R^2=</span><span class="sc">{</span>r2_test<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Train: RMSE=83108.20, R^2=0.02
Val: RMSE=111435.42, R^2=-0.12
Test: RMSE=37364.36, R^2=0.54</code></pre>
</div>
</div>
</section>
<section id="random-search" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="random-search"><span class="header-section-number">5.4</span> Random Search</h2>
<div id="cell-32" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> loguniform, randint</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-33" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>param_dist <span class="op">=</span> {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'alpha'</span>: loguniform(<span class="fl">1e-3</span>, <span class="fl">1e4</span>),  <span class="co"># alpha in [1e-3, 1e4]</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_iter'</span>: randint(<span class="dv">10</span>, <span class="dv">5000</span>)    <span class="co"># integer in [10, 5000)</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Random Search will sample from these hyperparameter distributions:"</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p, dist <span class="kw">in</span> param_dist.items():</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>p<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>dist<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Search will sample from these hyperparameter distributions:
  alpha: &lt;scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x00000206FCD59C90&gt;
  max_iter: &lt;scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x00000206A376B5E0&gt;</code></pre>
</div>
</div>
<div id="cell-34" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>random_search <span class="op">=</span> RandomizedSearchCV(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    estimator<span class="op">=</span>Lasso(),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    param_distributions<span class="op">=</span>param_dist,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    n_iter<span class="op">=</span><span class="dv">100</span>,         <span class="co"># try 100 combinations of hyperparameters</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    scoring<span class="op">=</span><span class="st">'r2'</span>,       <span class="co"># optimize R^2</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    cv<span class="op">=</span><span class="dv">3</span>,               <span class="co"># 3-fold cross-validation</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    n_jobs<span class="op">=-</span><span class="dv">1</span>,          <span class="co"># use all CPU cores</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    verbose<span class="op">=</span><span class="dv">1</span>,          <span class="co"># get more information</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">509</span>   <span class="co"># random seed for reproducibility</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-35" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>X_use <span class="op">=</span> pd.concat([X_train, X_val]).head(<span class="dv">1_000</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>y_use <span class="op">=</span> pd.concat([y_train, y_val]).head(<span class="dv">1_000</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>random_search.fit(X_use, y_use)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting 3 folds for each of 100 candidates, totalling 300 fits</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="111">
<style>#sk-container-id-8 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-8 {
  color: var(--sklearn-color-text);
}

#sk-container-id-8 pre {
  padding: 0;
}

#sk-container-id-8 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-8 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-8 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-8 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-8 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-8 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-8 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-8 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-8 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-8 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-8 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-8 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-8 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-8 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "â–¸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-8 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-8 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-8 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-8 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-8 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-8 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-8 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "â–¾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-8 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-8 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-8 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-8 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-8 div.sk-label label.sk-toggleable__label,
#sk-container-id-8 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-8 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-8 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-8 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-8 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-8 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-8 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-8 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-8 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-8 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-8 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-8 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-8 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-8" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomizedSearchCV(cv=3, estimator=Lasso(), n_iter=100, n_jobs=-1,
                   param_distributions={'alpha': &lt;scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x0000022C10AFCD90&gt;,
                                        'max_iter': &lt;scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x0000022C10AFC2B0&gt;},
                   random_state=509, scoring='r2', verbose=1)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-18" type="checkbox"><label for="sk-estimator-id-18" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;RandomizedSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.RandomizedSearchCV.html">?<span>Documentation for RandomizedSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>RandomizedSearchCV(cv=3, estimator=Lasso(), n_iter=100, n_jobs=-1,
                   param_distributions={'alpha': &lt;scipy.stats._distn_infrastructure.rv_continuous_frozen object at 0x0000022C10AFCD90&gt;,
                                        'max_iter': &lt;scipy.stats._distn_infrastructure.rv_discrete_frozen object at 0x0000022C10AFC2B0&gt;},
                   random_state=509, scoring='r2', verbose=1)</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-19" type="checkbox"><label for="sk-estimator-id-19" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: Lasso</label><div class="sk-toggleable__content fitted"><pre>Lasso(alpha=11.87976242665855, max_iter=4585)</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-20" type="checkbox"><label for="sk-estimator-id-20" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;Lasso<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.Lasso.html">?<span>Documentation for Lasso</span></a></label><div class="sk-toggleable__content fitted"><pre>Lasso(alpha=11.87976242665855, max_iter=4585)</pre></div> </div></div></div></div></div></div></div></div></div>
</div>
</div>
<div id="cell-36" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">=== RandomizedSearchCV Results ==="</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best params:"</span>, random_search.best_params_)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Best CV R^2:"</span>, random_search.best_score_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== RandomizedSearchCV Results ===
Best params: {'alpha': 11.87976242665855, 'max_iter': 4585}
Best CV R^2: 0.5420305853566706</code></pre>
</div>
</div>
<div id="cell-37" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>random_search.cv_results_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>{'mean_fit_time': array([0.00737635, 0.01639032, 0.01452788, 0.00501291, 0.04865607,
        0.01253215, 0.05014253, 0.00518378, 0.08894293, 0.02473195,
        0.05683327, 0.07208387, 0.00651677, 0.01185878, 0.00600743,
        0.03046282, 0.09061797, 0.00571314, 0.11936307, 0.05818748,
        0.06519278, 0.00818102, 0.01420371, 0.02640192, 0.02172613,
        0.10365264, 0.01105404, 0.00752838, 0.04767585, 0.0122145 ,
        0.04615887, 0.02392403, 0.06422218, 0.00534638, 0.00819031,
        0.02107159, 0.00620969, 0.02257133, 0.02215878, 0.0058589 ,
        0.03905479, 0.02523359, 0.00855168, 0.06150262, 0.00893354,
        0.04353158, 0.04662975, 0.04958463, 0.03075496, 0.04376769,
        0.00590595, 0.06301188, 0.03838595, 0.00551462, 0.00738827,
        0.03568268, 0.06727751, 0.06562376, 0.06309589, 0.01212605,
        0.0331049 , 0.00838892, 0.01657891, 0.01964808, 0.05005956,
        0.06235242, 0.02657437, 0.00701213, 0.0794069 , 0.00569105,
        0.00764918, 0.06112719, 0.03223697, 0.01855874, 0.00620063,
        0.03276849, 0.06079261, 0.03860291, 0.02122442, 0.01420856,
        0.03156503, 0.07353059, 0.05423363, 0.02161821, 0.04045947,
        0.03861626, 0.01353343, 0.02875113, 0.01235851, 0.03482517,
        0.00718737, 0.03590711, 0.00666952, 0.03047832, 0.06564569,
        0.01893965, 0.00896454, 0.07621082, 0.06790129, 0.03906608]),
 'std_fit_time': array([1.67958452e-03, 8.73724982e-03, 1.63978843e-03, 4.05613952e-04,
        2.21663559e-02, 2.84767037e-03, 7.39208222e-03, 8.41094755e-04,
        1.10046686e-02, 7.44232506e-03, 5.85322258e-03, 8.26613458e-03,
        1.48905132e-03, 4.69303474e-04, 8.12185572e-04, 6.96491254e-03,
        2.99161743e-02, 6.60576794e-04, 3.23299963e-02, 1.13489552e-02,
        1.94861430e-02, 1.65986809e-03, 2.02777760e-03, 1.64585967e-02,
        1.62047012e-02, 2.78802631e-02, 7.08299118e-03, 2.15770102e-03,
        5.81393877e-03, 4.11876840e-03, 5.58135156e-03, 2.48585881e-03,
        8.28960495e-03, 2.32252032e-04, 3.77624596e-03, 3.21952392e-05,
        1.73483992e-03, 5.36638990e-03, 6.79017369e-03, 4.64458281e-04,
        3.33697065e-04, 2.64668318e-03, 3.59085691e-03, 5.72440339e-03,
        1.24292022e-03, 1.68863401e-03, 3.51517577e-03, 2.70577632e-03,
        2.25786544e-03, 1.34450798e-02, 5.41650784e-04, 3.08020392e-03,
        2.68891909e-02, 8.17642187e-04, 2.31822920e-03, 5.23972233e-03,
        3.12567154e-03, 1.41872583e-03, 3.27083835e-03, 6.12090416e-03,
        1.44103654e-03, 2.29257339e-03, 5.05138115e-03, 7.17119131e-03,
        7.00255602e-03, 1.31615073e-03, 7.11508852e-03, 2.05102492e-03,
        8.28487641e-03, 2.46682246e-04, 3.07663336e-03, 8.17167660e-04,
        2.16356222e-02, 1.86209100e-03, 4.78287769e-04, 2.73417813e-03,
        1.65906831e-03, 1.49385865e-03, 9.11587829e-03, 7.32717450e-03,
        2.16568832e-03, 7.42729709e-03, 6.29911919e-03, 3.50143653e-03,
        2.07802997e-02, 2.15676420e-03, 6.05368415e-03, 7.15206657e-03,
        1.18764201e-03, 2.40109224e-03, 2.39985707e-03, 1.52378124e-03,
        1.24834843e-03, 9.95697505e-03, 1.04496721e-02, 2.19201311e-03,
        7.91854996e-04, 7.63317247e-03, 1.58837620e-03, 7.95502729e-03]),
 'mean_score_time': array([0.00385745, 0.00419386, 0.0058674 , 0.00251285, 0.00518211,
        0.00318352, 0.00317963, 0.00468183, 0.005011  , 0.00402204,
        0.0051918 , 0.00366863, 0.00285157, 0.00301218, 0.00367649,
        0.00450945, 0.00434534, 0.00417097, 0.00299939, 0.00535496,
        0.00301282, 0.00435313, 0.0158724 , 0.00350563, 0.00334223,
        0.00517472, 0.00834982, 0.00334899, 0.00416454, 0.00300447,
        0.00366783, 0.00384339, 0.00332562, 0.00400408, 0.00284489,
        0.00451851, 0.00333802, 0.00424115, 0.00385801, 0.00333444,
        0.00390561, 0.00467396, 0.00321468, 0.00333842, 0.00450985,
        0.00451104, 0.00455006, 0.00300646, 0.00367602, 0.00411669,
        0.004028  , 0.00417972, 0.00535909, 0.00334024, 0.0028193 ,
        0.00351357, 0.00300209, 0.00385682, 0.00401982, 0.00451159,
        0.00970014, 0.00394758, 0.00518258, 0.00334064, 0.00335344,
        0.00350539, 0.00467531, 0.0066251 , 0.00617671, 0.00334104,
        0.00286595, 0.00334183, 0.0035398 , 0.00720326, 0.00400281,
        0.00501704, 0.0048426 , 0.00384816, 0.00518163, 0.00366743,
        0.00471203, 0.00467825, 0.0051775 , 0.00435758, 0.00449316,
        0.0041786 , 0.00300821, 0.0036788 , 0.00486533, 0.00451406,
        0.00567921, 0.00416509, 0.00518664, 0.0063533 , 0.0036792 ,
        0.0031089 , 0.00317566, 0.00473134, 0.00438126, 0.00410954]),
 'std_score_time': array([6.47102674e-04, 1.29569666e-03, 2.63484896e-03, 7.19423057e-04,
        3.07026565e-03, 8.57176065e-04, 6.28801129e-04, 2.72112457e-03,
        4.17508730e-04, 8.18936743e-04, 1.85290143e-03, 9.41843587e-04,
        6.42283555e-04, 4.13389812e-04, 1.32014099e-03, 1.48168434e-03,
        2.24646807e-03, 1.04385510e-03, 1.80877156e-06, 2.63640415e-03,
        4.04703972e-04, 1.56059063e-03, 1.78494611e-02, 4.07778039e-04,
        4.69509136e-04, 1.65576367e-03, 6.86664480e-03, 4.85106541e-04,
        2.43201157e-04, 1.62572025e-05, 9.42418190e-04, 1.02898922e-03,
        4.55074613e-04, 8.23933960e-04, 6.28931291e-04, 2.11400786e-03,
        4.74142421e-04, 1.40483303e-03, 6.38469474e-04, 4.71932673e-04,
        2.96640133e-04, 8.55301988e-04, 2.14902519e-04, 4.74044023e-04,
        1.22904976e-03, 1.48633288e-03, 8.41452551e-04, 4.05807239e-04,
        2.28031248e-04, 1.04471786e-03, 4.10935399e-04, 2.40524916e-03,
        2.36380545e-03, 4.73921245e-04, 2.09616172e-04, 3.98099537e-04,
        6.90434857e-04, 4.88456359e-04, 8.21897634e-04, 2.13566639e-03,
        5.95525119e-03, 1.38965938e-03, 6.19898250e-04, 4.68437373e-04,
        4.89375311e-04, 4.08442704e-04, 2.72281049e-03, 2.85458159e-03,
        3.80312721e-03, 4.68497718e-04, 5.00933126e-04, 4.77691098e-04,
        4.24909402e-04, 3.48565799e-03, 8.18095988e-04, 3.25158220e-03,
        8.49565309e-04, 2.45371241e-04, 1.65294875e-03, 4.69069245e-04,
        6.32594848e-04, 2.01834502e-03, 2.40536788e-03, 1.54915370e-03,
        4.20679852e-04, 8.53528575e-04, 6.92463586e-06, 6.23267968e-04,
        1.46452099e-03, 1.47243287e-03, 2.72863694e-03, 1.03868517e-03,
        1.70533600e-03, 2.32324549e-03, 1.31701217e-03, 9.52650083e-04,
        2.41834515e-04, 1.31617976e-03, 3.01597279e-03, 2.23220670e-03]),
 'param_alpha': masked_array(data=[195.48405222863136, 82.56029576197498,
                    0.44024351225185143, 364.0701112808811,
                    53.727140757694336, 0.0043970564429580234,
                    0.03590927096469022, 9980.865434069025,
                    0.002859570703723829, 68.23620415720254,
                    0.02786619091895085, 0.005574267134998345,
                    1528.0547398319738, 21.63340002058571,
                    351.8379927192362, 0.021022167265373932,
                    2.321345973691301, 5252.8186891347095,
                    0.08187807832790248, 0.030739933220278234,
                    4.942470567858895, 179.13521431417263,
                    0.001177995364294815, 4.562168492227108,
                    0.002207275376044895, 0.014025771845171363,
                    3390.080431689054, 496.44710663064103,
                    0.9401173957764195, 279.9544005549383,
                    0.004040045367342484, 1.8372523401167777,
                    11.671067370512267, 3673.757325304093,
                    270.122183566781, 0.002651348387177266,
                    1236.452077007676, 2.0369493311953026,
                    49.540735270318905, 9017.145602941444,
                    3.1897003451724237, 15.909005271591043,
                    270.5949990606467, 15.137747350461387,
                    350.89109688767945, 0.008675038900473228,
                    1.2870872989629856, 0.003803559141377889,
                    0.07258854342439401, 37.43482657508818,
                    2008.7689880811952, 0.04881183888256398,
                    63.8819190813346, 3554.968069875446, 792.7423587690853,
                    0.49233448299839666, 24.14622420657272,
                    0.5558866110877222, 23.21656369692641,
                    331.8103818659524, 0.002128244975686662,
                    520.0636441296363, 140.40308635230468,
                    77.27545764780585, 0.36743797569455094,
                    0.20534478509228804, 8.932900065010093,
                    5642.591615624239, 0.008000368916087281,
                    4.873423508938212, 1213.525631228544,
                    0.5447174208915585, 62.18010099049566,
                    0.13219595827549685, 1105.3277407711132,
                    0.00308637973690833, 5.4049607969252085,
                    5.194844024734802, 72.3076580431818, 138.0676055792673,
                    11.827851064389034, 8.47955879881921, 3.46048879759531,
                    0.04203177850537053, 0.005418819150254471,
                    0.026016689740516158, 108.43077219430774,
                    0.03141610961665743, 0.01668099427846113,
                    1.1480918541790852, 6091.199063147831,
                    0.5057140744171967, 734.3400569136479,
                    17.596719675694793, 5.798883543365199,
                    48.83292778582255, 185.40778026381705,
                    11.87976242665855, 0.6138735273878335,
                    0.005426812420837048],
              mask=[False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False],
        fill_value=1e+20),
 'param_max_iter': masked_array(data=[3865, 607, 1070, 2827, 4182, 526, 2264, 4712, 4893,
                    2164, 3097, 4409, 139, 585, 1400, 1170, 4282, 4238,
                    4628, 3488, 2584, 1975, 726, 978, 323, 4637, 593, 4239,
                    2364, 4507, 2702, 1107, 3690, 2265, 4365, 1321, 1415,
                    901, 1114, 1777, 2421, 1399, 3203, 4266, 708, 2458,
                    2527, 3109, 1826, 3587, 3527, 3698, 4611, 3260, 1908,
                    1801, 4268, 3988, 3549, 449, 1889, 466, 3433, 2071,
                    2629, 3489, 1265, 2679, 4675, 132, 2778, 3595, 3895,
                    935, 1996, 1624, 3828, 2393, 2066, 2585, 1986, 4185,
                    3198, 1000, 1703, 2709, 3285, 1677, 597, 2374, 2999,
                    2309, 2184, 1642, 3276, 1074, 4879, 4585, 4319, 2148],
              mask=[False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False, False, False, False, False,
                    False, False, False, False],
        fill_value=999999),
 'params': [{'alpha': 195.48405222863136, 'max_iter': 3865},
  {'alpha': 82.56029576197498, 'max_iter': 607},
  {'alpha': 0.44024351225185143, 'max_iter': 1070},
  {'alpha': 364.0701112808811, 'max_iter': 2827},
  {'alpha': 53.727140757694336, 'max_iter': 4182},
  {'alpha': 0.0043970564429580234, 'max_iter': 526},
  {'alpha': 0.03590927096469022, 'max_iter': 2264},
  {'alpha': 9980.865434069025, 'max_iter': 4712},
  {'alpha': 0.002859570703723829, 'max_iter': 4893},
  {'alpha': 68.23620415720254, 'max_iter': 2164},
  {'alpha': 0.02786619091895085, 'max_iter': 3097},
  {'alpha': 0.005574267134998345, 'max_iter': 4409},
  {'alpha': 1528.0547398319738, 'max_iter': 139},
  {'alpha': 21.63340002058571, 'max_iter': 585},
  {'alpha': 351.8379927192362, 'max_iter': 1400},
  {'alpha': 0.021022167265373932, 'max_iter': 1170},
  {'alpha': 2.321345973691301, 'max_iter': 4282},
  {'alpha': 5252.8186891347095, 'max_iter': 4238},
  {'alpha': 0.08187807832790248, 'max_iter': 4628},
  {'alpha': 0.030739933220278234, 'max_iter': 3488},
  {'alpha': 4.942470567858895, 'max_iter': 2584},
  {'alpha': 179.13521431417263, 'max_iter': 1975},
  {'alpha': 0.001177995364294815, 'max_iter': 726},
  {'alpha': 4.562168492227108, 'max_iter': 978},
  {'alpha': 0.002207275376044895, 'max_iter': 323},
  {'alpha': 0.014025771845171363, 'max_iter': 4637},
  {'alpha': 3390.080431689054, 'max_iter': 593},
  {'alpha': 496.44710663064103, 'max_iter': 4239},
  {'alpha': 0.9401173957764195, 'max_iter': 2364},
  {'alpha': 279.9544005549383, 'max_iter': 4507},
  {'alpha': 0.004040045367342484, 'max_iter': 2702},
  {'alpha': 1.8372523401167777, 'max_iter': 1107},
  {'alpha': 11.671067370512267, 'max_iter': 3690},
  {'alpha': 3673.757325304093, 'max_iter': 2265},
  {'alpha': 270.122183566781, 'max_iter': 4365},
  {'alpha': 0.002651348387177266, 'max_iter': 1321},
  {'alpha': 1236.452077007676, 'max_iter': 1415},
  {'alpha': 2.0369493311953026, 'max_iter': 901},
  {'alpha': 49.540735270318905, 'max_iter': 1114},
  {'alpha': 9017.145602941444, 'max_iter': 1777},
  {'alpha': 3.1897003451724237, 'max_iter': 2421},
  {'alpha': 15.909005271591043, 'max_iter': 1399},
  {'alpha': 270.5949990606467, 'max_iter': 3203},
  {'alpha': 15.137747350461387, 'max_iter': 4266},
  {'alpha': 350.89109688767945, 'max_iter': 708},
  {'alpha': 0.008675038900473228, 'max_iter': 2458},
  {'alpha': 1.2870872989629856, 'max_iter': 2527},
  {'alpha': 0.003803559141377889, 'max_iter': 3109},
  {'alpha': 0.07258854342439401, 'max_iter': 1826},
  {'alpha': 37.43482657508818, 'max_iter': 3587},
  {'alpha': 2008.7689880811952, 'max_iter': 3527},
  {'alpha': 0.04881183888256398, 'max_iter': 3698},
  {'alpha': 63.8819190813346, 'max_iter': 4611},
  {'alpha': 3554.968069875446, 'max_iter': 3260},
  {'alpha': 792.7423587690853, 'max_iter': 1908},
  {'alpha': 0.49233448299839666, 'max_iter': 1801},
  {'alpha': 24.14622420657272, 'max_iter': 4268},
  {'alpha': 0.5558866110877222, 'max_iter': 3988},
  {'alpha': 23.21656369692641, 'max_iter': 3549},
  {'alpha': 331.8103818659524, 'max_iter': 449},
  {'alpha': 0.002128244975686662, 'max_iter': 1889},
  {'alpha': 520.0636441296363, 'max_iter': 466},
  {'alpha': 140.40308635230468, 'max_iter': 3433},
  {'alpha': 77.27545764780585, 'max_iter': 2071},
  {'alpha': 0.36743797569455094, 'max_iter': 2629},
  {'alpha': 0.20534478509228804, 'max_iter': 3489},
  {'alpha': 8.932900065010093, 'max_iter': 1265},
  {'alpha': 5642.591615624239, 'max_iter': 2679},
  {'alpha': 0.008000368916087281, 'max_iter': 4675},
  {'alpha': 4.873423508938212, 'max_iter': 132},
  {'alpha': 1213.525631228544, 'max_iter': 2778},
  {'alpha': 0.5447174208915585, 'max_iter': 3595},
  {'alpha': 62.18010099049566, 'max_iter': 3895},
  {'alpha': 0.13219595827549685, 'max_iter': 935},
  {'alpha': 1105.3277407711132, 'max_iter': 1996},
  {'alpha': 0.00308637973690833, 'max_iter': 1624},
  {'alpha': 5.4049607969252085, 'max_iter': 3828},
  {'alpha': 5.194844024734802, 'max_iter': 2393},
  {'alpha': 72.3076580431818, 'max_iter': 2066},
  {'alpha': 138.0676055792673, 'max_iter': 2585},
  {'alpha': 11.827851064389034, 'max_iter': 1986},
  {'alpha': 8.47955879881921, 'max_iter': 4185},
  {'alpha': 3.46048879759531, 'max_iter': 3198},
  {'alpha': 0.04203177850537053, 'max_iter': 1000},
  {'alpha': 0.005418819150254471, 'max_iter': 1703},
  {'alpha': 0.026016689740516158, 'max_iter': 2709},
  {'alpha': 108.43077219430774, 'max_iter': 3285},
  {'alpha': 0.03141610961665743, 'max_iter': 1677},
  {'alpha': 0.01668099427846113, 'max_iter': 597},
  {'alpha': 1.1480918541790852, 'max_iter': 2374},
  {'alpha': 6091.199063147831, 'max_iter': 2999},
  {'alpha': 0.5057140744171967, 'max_iter': 2309},
  {'alpha': 734.3400569136479, 'max_iter': 2184},
  {'alpha': 17.596719675694793, 'max_iter': 1642},
  {'alpha': 5.798883543365199, 'max_iter': 3276},
  {'alpha': 48.83292778582255, 'max_iter': 1074},
  {'alpha': 185.40778026381705, 'max_iter': 4879},
  {'alpha': 11.87976242665855, 'max_iter': 4585},
  {'alpha': 0.6138735273878335, 'max_iter': 4319},
  {'alpha': 0.005426812420837048, 'max_iter': 2148}],
 'split0_test_score': array([0.66253522, 0.67167592, 0.67648791, 0.65588383, 0.67545591,
        0.67516686, 0.68145967, 0.35585537, 0.68650425, 0.67335251,
        0.68408879, 0.68617856, 0.62986633, 0.67646047, 0.65617531,
        0.67684697, 0.68660344, 0.50116831, 0.68637276, 0.68494438,
        0.68360245, 0.6632763 , 0.67545733, 0.67652143, 0.67545981,
        0.68635756, 0.57540059, 0.65322439, 0.68200221, 0.65783852,
        0.68297784, 0.67671005, 0.6858444 , 0.56542738, 0.65805894,
        0.67745887, 0.63739958, 0.67605719, 0.67602361, 0.36938335,
        0.68267345, 0.68004765, 0.65804838, 0.68505362, 0.65619783,
        0.68216799, 0.68266453, 0.68411223, 0.67966412, 0.67749421,
        0.61592583, 0.68531873, 0.67392623, 0.569662  , 0.64745221,
        0.6796006 , 0.68223141, 0.68590111, 0.68274139, 0.65664818,
        0.67992745, 0.65279154, 0.66615542, 0.67206349, 0.68282415,
        0.6849944 , 0.67830876, 0.48383965, 0.68638097, 0.67463271,
        0.63796016, 0.68528023, 0.67418561, 0.67602085, 0.64054597,
        0.67877241, 0.68616338, 0.68297496, 0.67271039, 0.66641929,
        0.68253103, 0.68644195, 0.68503934, 0.67622713, 0.67912001,
        0.68300461, 0.66963977, 0.67900761, 0.67523228, 0.68207782,
        0.46283184, 0.68171488, 0.64864908, 0.68093306, 0.68515703,
        0.67612174, 0.66300149, 0.68680439, 0.68628195, 0.6810011 ]),
 'split1_test_score': array([0.60973181, 0.60923967, 0.6018751 , 0.60572335, 0.60716037,
        0.60439775, 0.59550651, 0.37964056, 0.58332131, 0.60930811,
        0.59072505, 0.58492286, 0.59176321, 0.60682279, 0.60570417,
        0.60138906, 0.58768976, 0.51294919, 0.58425961, 0.58875991,
        0.59610923, 0.6101766 , 0.60322616, 0.60292092, 0.60620197,
        0.58414978, 0.56115113, 0.60539417, 0.59531811, 0.60569824,
        0.59289928, 0.60198179, 0.59557535, 0.55503628, 0.60647029,
        0.6007215 , 0.59699226, 0.60281189, 0.60569497, 0.38583732,
        0.5960716 , 0.60341396, 0.6064402 , 0.5964127 , 0.6057014 ,
        0.59433342, 0.59457541, 0.59064311, 0.59810794, 0.60290937,
        0.58376656, 0.58780874, 0.60869041, 0.55749827, 0.60279787,
        0.59838149, 0.60009867, 0.58708137, 0.59852111, 0.60565311,
        0.59772199, 0.60523035, 0.61090927, 0.61025691, 0.59352156,
        0.58891023, 0.60271054, 0.49997018, 0.58401755, 0.60949635,
        0.59735775, 0.58872371, 0.60846876, 0.60235482, 0.59897956,
        0.59920821, 0.59169046, 0.59708526, 0.609766  , 0.61091454,
        0.60080737, 0.59305747, 0.5925966 , 0.60208232, 0.59877873,
        0.59287186, 0.61142735, 0.59892912, 0.60392885, 0.59535454,
        0.48377601, 0.59544423, 0.60336842, 0.6028404 , 0.59361747,
        0.60546618, 0.61001789, 0.59474388, 0.58590504, 0.59618986]),
 'split2_test_score': array([0.32097615, 0.33533594, 0.3329735 , 0.32961835, 0.33759228,
        0.32982083, 0.34162957, 0.26391336, 0.35270058, 0.33618418,
        0.34683763, 0.35176105, 0.34928982, 0.33083587, 0.32911074,
        0.33386313, 0.34954649, 0.33648756, 0.35219459, 0.34871197,
        0.3406831 , 0.32244665, 0.33164028, 0.32845134, 0.32249174,
        0.35224722, 0.35134073, 0.33464799, 0.34203637, 0.3260837 ,
        0.34457274, 0.33199724, 0.34303893, 0.34999889, 0.32565122,
        0.33481107, 0.34709514, 0.3306835 , 0.33841482, 0.27239916,
        0.34043488, 0.33609605, 0.3256719 , 0.34152997, 0.32907348,
        0.34298477, 0.34301691, 0.34691209, 0.3383952 , 0.33956279,
        0.35162744, 0.34955786, 0.33653925, 0.35060089, 0.34171991,
        0.3380455 , 0.33455114, 0.35028167, 0.33654048, 0.32829275,
        0.33889164, 0.33546193, 0.32822448, 0.3354893 , 0.34398648,
        0.34862243, 0.33037538, 0.33122415, 0.35232338, 0.30158671,
        0.34687742, 0.34887339, 0.33665499, 0.33253497, 0.34576181,
        0.33692368, 0.34691904, 0.33945535, 0.3358804 , 0.32871433,
        0.33875723, 0.34611638, 0.34446   , 0.3329252 , 0.33750434,
        0.34460839, 0.33264205, 0.33730221, 0.33069946, 0.34203822,
        0.32409784, 0.3417941 , 0.34083064, 0.33800635, 0.34501063,
        0.3386464 , 0.32151599, 0.34454349, 0.35119575, 0.34080516]),
 'mean_test_score': array([0.53108106, 0.53875051, 0.53711217, 0.53040851, 0.54006952,
        0.53646181, 0.53953192, 0.33313643, 0.54084204, 0.53961493,
        0.54055049, 0.54095416, 0.52363979, 0.53803971, 0.53033007,
        0.53736639, 0.5412799 , 0.45020169, 0.54094232, 0.54080542,
        0.54013159, 0.53196651, 0.53677459, 0.53596456, 0.53471784,
        0.54091819, 0.49596415, 0.53108885, 0.53978556, 0.52987348,
        0.54014995, 0.53689636, 0.54148623, 0.49015419, 0.53006015,
        0.53766382, 0.52716233, 0.53651753, 0.54004447, 0.34253994,
        0.53972665, 0.53985255, 0.53005349, 0.54099876, 0.53032423,
        0.53982873, 0.54008562, 0.54055581, 0.53872242, 0.53998879,
        0.51710661, 0.54089511, 0.53971863, 0.49258705, 0.53065666,
        0.53867586, 0.53896041, 0.54108805, 0.53926766, 0.53019801,
        0.53884703, 0.53116127, 0.53509639, 0.5392699 , 0.54011073,
        0.54084236, 0.53713156, 0.43834466, 0.5409073 , 0.52857192,
        0.52739844, 0.54095911, 0.53976979, 0.53697021, 0.52842911,
        0.53830143, 0.54159096, 0.53983852, 0.53945226, 0.53534939,
        0.54069854, 0.54187193, 0.54069864, 0.53707821, 0.53846769,
        0.54016162, 0.53790306, 0.53841298, 0.5366202 , 0.53982352,
        0.42356856, 0.53965107, 0.53094938, 0.54059327, 0.54126171,
        0.54007811, 0.53151179, 0.54203059, 0.54112758, 0.53933204]),
 'std_test_score': array([0.15012241, 0.14607689, 0.14752675, 0.14344926, 0.14586259,
        0.14894616, 0.14427056, 0.04990196, 0.1395459 , 0.14620414,
        0.14217994, 0.14002072, 0.12426154, 0.14924795, 0.14376775,
        0.147159  , 0.14146202, 0.08055174, 0.13982383, 0.14139256,
        0.14548435, 0.14973048, 0.14801891, 0.14977886, 0.15270691,
        0.13978354, 0.10242953, 0.14027043, 0.14423844, 0.14566482,
        0.1430999 , 0.14806263, 0.14508187, 0.09919551, 0.14606529,
        0.1468198 , 0.1283909 , 0.14858657, 0.14543593, 0.05004985,
        0.14528793, 0.14743522, 0.14604732, 0.14561399, 0.14379122,
        0.14373444, 0.14391428, 0.14214438, 0.14551311, 0.14495668,
        0.11774569, 0.14103075, 0.14611713, 0.10052211, 0.13483651,
        0.14569041, 0.14837746, 0.14082292, 0.1474155 , 0.1442785 ,
        0.14531816, 0.13973592, 0.14800906, 0.14628719, 0.14339289,
        0.14146711, 0.1494208 , 0.07603136, 0.13974379, 0.16269071,
        0.12871938, 0.14142956, 0.14610816, 0.14765274, 0.13027522,
        0.14605334, 0.14295489, 0.14596649, 0.14622272, 0.14785969,
        0.14663995, 0.14357423, 0.14380223, 0.14749735, 0.14583868,
        0.1430892 , 0.14707421, 0.14591618, 0.14848919, 0.14426712,
        0.07085423, 0.14427102, 0.13569926, 0.14675538, 0.14371438,
        0.14532515, 0.15005664, 0.14461362, 0.14041475, 0.1445866 ]),
 'rank_test_score': array([ 77,  50,  61,  80,  30,  68,  43, 100,  17,  42,  23,  11,  91,
         56,  81,  59,   5,  96,  12,  18,  26,  73,  65,  69,  72,  13,
         93,  76,  37,  86,  25,  64,   4,  95,  84,  58,  90,  67,  31,
         99,  39,  33,  85,   9,  82,  35,  28,  22,  51,  32,  92,  15,
         40,  94,  79,  52,  48,   8,  47,  83,  49,  75,  71,  46,  27,
         16,  60,  97,  14,  87,  89,  10,  38,  63,  88,  55,   3,  34,
         44,  70,  20,   2,  19,  62,  53,  24,  57,  54,  66,  36,  98,
         41,  78,  21,   6,  29,  74,   1,   7,  45])}</code></pre>
</div>
</div>
<div id="cell-38" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppose you already have a fitted RandomizedSearchCV object named random_search</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>random_results_df <span class="op">=</span> pd.DataFrame(random_search.cv_results_)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Each hyperparameter is in a column with 'param_' prefix:</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># e.g., 'param_alpha', 'param_max_iter', etc.</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># You can display them along with the mean CV score, etc.</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>df_random_search <span class="op">=</span> random_results_df[</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'param_alpha'</span>, <span class="st">'param_max_iter'</span>, <span class="st">'mean_test_score'</span>, <span class="st">'rank_test_score'</span>]</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>].sort_values(by<span class="op">=</span><span class="st">'mean_test_score'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>df_random_search</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">param_alpha</th>
<th data-quarto-table-cell-role="th">param_max_iter</th>
<th data-quarto-table-cell-role="th">mean_test_score</th>
<th data-quarto-table-cell-role="th">rank_test_score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">97</td>
<td>11.879762</td>
<td>4585</td>
<td>0.542031</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">81</td>
<td>8.479559</td>
<td>4185</td>
<td>0.541872</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76</td>
<td>5.404961</td>
<td>3828</td>
<td>0.541591</td>
<td>3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32</td>
<td>11.671067</td>
<td>3690</td>
<td>0.541486</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>2.321346</td>
<td>4282</td>
<td>0.541280</td>
<td>5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">17</td>
<td>5252.818689</td>
<td>4238</td>
<td>0.450202</td>
<td>96</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">67</td>
<td>5642.591616</td>
<td>2679</td>
<td>0.438345</td>
<td>97</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">90</td>
<td>6091.199063</td>
<td>2999</td>
<td>0.423569</td>
<td>98</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">39</td>
<td>9017.145603</td>
<td>1777</td>
<td>0.342540</td>
<td>99</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>9980.865434</td>
<td>4712</td>
<td>0.333136</td>
<td>100</td>
</tr>
</tbody>
</table>

<p>100 rows Ã— 4 columns</p>
</div>
</div>
</div>
<div id="cell-39" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>px.scatter(df_random_search, x<span class="op">=</span><span class="st">"param_alpha"</span>, y<span class="op">=</span><span class="st">"param_max_iter"</span>, color<span class="op">=</span><span class="st">"mean_test_score"</span>, </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>           title<span class="op">=</span><span class="st">"Random Search"</span>, log_x<span class="op">=</span><span class="va">True</span>, log_y<span class="op">=</span><span class="va">True</span>, color_continuous_scale<span class="op">=</span><span class="st">"viridis"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>
</section>
<section id="bayesian-optimization" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="bayesian-optimization"><span class="header-section-number">5.5</span> Bayesian Optimization</h2>
<p>Sklearn</p>
<p><code>!pip install scikit-optimize</code></p>
<p><code>from skopt import BayesSearchCV</code></p>
<p>Hyperopt</p>
<div id="cell-43" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install hyperopt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Collecting hyperopt
  Downloading hyperopt-0.2.7-py2.py3-none-any.whl.metadata (1.7 kB)
Requirement already satisfied: numpy in c:\users\hayk_\.conda\envs\thesis\lib\site-packages (from hyperopt) (1.26.4)
Requirement already satisfied: scipy in c:\users\hayk_\.conda\envs\thesis\lib\site-packages (from hyperopt) (1.13.0)
Requirement already satisfied: six in c:\users\hayk_\.conda\envs\thesis\lib\site-packages (from hyperopt) (1.16.0)
Requirement already satisfied: networkx&gt;=2.2 in c:\users\hayk_\.conda\envs\thesis\lib\site-packages (from hyperopt) (3.3)
Collecting future (from hyperopt)
  Using cached future-1.0.0-py3-none-any.whl.metadata (4.0 kB)
Requirement already satisfied: tqdm in c:\users\hayk_\.conda\envs\thesis\lib\site-packages (from hyperopt) (4.66.2)
Collecting cloudpickle (from hyperopt)
  Downloading cloudpickle-3.1.1-py3-none-any.whl.metadata (7.1 kB)
Collecting py4j (from hyperopt)
  Downloading py4j-0.10.9.9-py2.py3-none-any.whl.metadata (1.3 kB)
Requirement already satisfied: colorama in c:\users\hayk_\.conda\envs\thesis\lib\site-packages (from tqdm-&gt;hyperopt) (0.4.6)
Downloading hyperopt-0.2.7-py2.py3-none-any.whl (1.6 MB)
   ---------------------------------------- 1.6/1.6 MB 2.3 MB/s eta 0:00:00
Downloading cloudpickle-3.1.1-py3-none-any.whl (20 kB)
Using cached future-1.0.0-py3-none-any.whl (491 kB)
Downloading py4j-0.10.9.9-py2.py3-none-any.whl (203 kB)
   ---------------------------------------- 203.0/203.0 kB 2.4 MB/s eta 0:00:00
Installing collected packages: py4j, future, cloudpickle, hyperopt
Successfully installed cloudpickle-3.1.1 future-1.0.0 hyperopt-0.2.7 py4j-0.10.9.9</code></pre>
</div>
</div>
<div id="cell-44" class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score, train_test_split, KFold</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-45" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> hyperopt <span class="im">import</span> fmin, tpe, hp, Trials, STATUS_OK</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-46" class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Define the search space for alpha and max_iter</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>space <span class="op">=</span> {</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'alpha'</span>: hp.loguniform(<span class="st">'alpha'</span>, np.log(<span class="fl">1e-3</span>), np.log(<span class="fl">1e3</span>)),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_iter'</span>: hp.randint(<span class="st">'max_iter'</span>, <span class="dv">5000</span>)  <span class="co"># integer in [0, 5000)</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Weâ€™ll do 5-fold cross-validation to evaluate each set of params</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> KFold(n_splits<span class="op">=</span><span class="dv">5</span>, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> objective(params):</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract hyperparameters</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    alpha <span class="op">=</span> params[<span class="st">'alpha'</span>]</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    max_iter <span class="op">=</span> <span class="bu">int</span>(params[<span class="st">'max_iter'</span>])  <span class="co"># ensure integer</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create Lasso model</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> Lasso(alpha<span class="op">=</span>alpha, max_iter<span class="op">=</span>max_iter, random_state<span class="op">=</span><span class="dv">509</span>)</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cross-validate (negative MSE, so we can minimize it)</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    mse_scores <span class="op">=</span> <span class="op">-</span>cross_val_score(</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>        model, X_train, y_train,</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>        cv<span class="op">=</span>cv, scoring<span class="op">=</span><span class="st">'neg_mean_squared_error'</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    avg_mse <span class="op">=</span> np.mean(mse_scores)</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Hyperopt tries to minimize the returned value</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'loss'</span>: avg_mse,</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'status'</span>: STATUS_OK,</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Optional: attach other info if you like</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">'params'</span>: params</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-47" class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>trials <span class="op">=</span> Trials()  <span class="co"># To store results</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>best <span class="op">=</span> fmin(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    fn<span class="op">=</span>objective,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    space<span class="op">=</span>space,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    algo<span class="op">=</span>tpe.suggest,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    max_evals<span class="op">=</span><span class="dv">20</span>,       <span class="co"># Number of trials (increase for better search)</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    trials<span class="op">=</span>trials,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    rstate<span class="op">=</span>np.random.default_rng(<span class="dv">509</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Best hyperparameters found:"</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(best)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 20/20 [00:06&lt;00:00,  3.11trial/s, best loss: 5158148188.803587]

Best hyperparameters found:
{'alpha': 82.26205843443854, 'max_iter': 3194}</code></pre>
</div>
</div>
<div id="cell-48" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>best_alpha <span class="op">=</span> best[<span class="st">'alpha'</span>]</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>best_max_iter <span class="op">=</span> <span class="bu">int</span>(best[<span class="st">'max_iter'</span>])</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>model_best <span class="op">=</span> Lasso(alpha<span class="op">=</span>best_alpha, max_iter<span class="op">=</span>best_max_iter, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>model_best.fit(X_train, y_train)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate on the test set</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>y_pred_test <span class="op">=</span> model_best.predict(X_test)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>rmse, r2 <span class="op">=</span> evaluate_model(y_test, y_pred_test)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Test set: RMSE=</span><span class="sc">{</span>rmse<span class="sc">:.2f}</span><span class="ss">, R^2=</span><span class="sc">{</span>r2<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Test set: RMSE=35930.87, R^2=0.58</code></pre>
</div>
</div>
<div id="cell-49" class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> pd.DataFrame(trials.results)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>results_df <span class="op">=</span> results_df.sort_values(by<span class="op">=</span><span class="st">'loss'</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>results_df[<span class="st">"alpha"</span>] <span class="op">=</span> results_df[<span class="st">"params"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">"alpha"</span>])</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>results_df[<span class="st">"max_iter"</span>] <span class="op">=</span> results_df[<span class="st">"params"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">"max_iter"</span>])</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>results_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="136">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">loss</th>
<th data-quarto-table-cell-role="th">status</th>
<th data-quarto-table-cell-role="th">params</th>
<th data-quarto-table-cell-role="th">alpha</th>
<th data-quarto-table-cell-role="th">max_iter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">14</td>
<td>5.158148e+09</td>
<td>ok</td>
<td>{'alpha': 82.26205843443854, 'max_iter': 3194}</td>
<td>82.262058</td>
<td>3194</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5.167013e+09</td>
<td>ok</td>
<td>{'alpha': 23.927000650080377, 'max_iter': 206}</td>
<td>23.927001</td>
<td>206</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13</td>
<td>5.290333e+09</td>
<td>ok</td>
<td>{'alpha': 347.92671616536, 'max_iter': 1292}</td>
<td>347.926716</td>
<td>1292</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11</td>
<td>5.358360e+09</td>
<td>ok</td>
<td>{'alpha': 28.505108573753763, 'max_iter': 2196}</td>
<td>28.505109</td>
<td>2196</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>5.384187e+09</td>
<td>ok</td>
<td>{'alpha': 0.013918988887753607, 'max_iter': 429}</td>
<td>0.013919</td>
<td>429</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10</td>
<td>5.839504e+09</td>
<td>ok</td>
<td>{'alpha': 0.0027521976271328466, 'max_iter': 792}</td>
<td>0.002752</td>
<td>792</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>6.432845e+09</td>
<td>ok</td>
<td>{'alpha': 0.037966985847236734, 'max_iter': 1196}</td>
<td>0.037967</td>
<td>1196</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>6.677457e+09</td>
<td>ok</td>
<td>{'alpha': 0.0014052766974551073, 'max_iter': 1...</td>
<td>0.001405</td>
<td>1355</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>7.403906e+09</td>
<td>ok</td>
<td>{'alpha': 0.002452008538580964, 'max_iter': 1820}</td>
<td>0.002452</td>
<td>1820</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">18</td>
<td>7.584504e+09</td>
<td>ok</td>
<td>{'alpha': 9.753940120503824, 'max_iter': 2707}</td>
<td>9.753940</td>
<td>2707</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">12</td>
<td>7.606741e+09</td>
<td>ok</td>
<td>{'alpha': 0.003579672035114573, 'max_iter': 1949}</td>
<td>0.003580</td>
<td>1949</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>8.507748e+09</td>
<td>ok</td>
<td>{'alpha': 6.800025058217788, 'max_iter': 2774}</td>
<td>6.800025</td>
<td>2774</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">5</td>
<td>8.672568e+09</td>
<td>ok</td>
<td>{'alpha': 0.37204177639824826, 'max_iter': 2589}</td>
<td>0.372042</td>
<td>2589</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>8.991760e+09</td>
<td>ok</td>
<td>{'alpha': 0.010823774548987567, 'max_iter': 2817}</td>
<td>0.010824</td>
<td>2817</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19</td>
<td>9.788528e+09</td>
<td>ok</td>
<td>{'alpha': 1.4345076433491972, 'max_iter': 3130}</td>
<td>1.434508</td>
<td>3130</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>1.011915e+10</td>
<td>ok</td>
<td>{'alpha': 0.1789505548304415, 'max_iter': 3469}</td>
<td>0.178951</td>
<td>3469</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>1.099852e+10</td>
<td>ok</td>
<td>{'alpha': 2.932516616065772, 'max_iter': 3607}</td>
<td>2.932517</td>
<td>3607</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17</td>
<td>1.115259e+10</td>
<td>ok</td>
<td>{'alpha': 0.281485107534971, 'max_iter': 4041}</td>
<td>0.281485</td>
<td>4041</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7</td>
<td>1.126640e+10</td>
<td>ok</td>
<td>{'alpha': 0.01712767443580885, 'max_iter': 4151}</td>
<td>0.017128</td>
<td>4151</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">0</td>
<td>1.148764e+10</td>
<td>ok</td>
<td>{'alpha': 0.23009145552081606, 'max_iter': 4237}</td>
<td>0.230091</td>
<td>4237</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-50" class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>px.scatter(results_df, x<span class="op">=</span><span class="st">"alpha"</span>, y<span class="op">=</span><span class="st">"max_iter"</span>, title<span class="op">=</span><span class="st">"Hyperopt Search"</span>,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>              log_x<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../ml/01_Regression_Main_Concepts/Code/C1_Regression_Main_Concepts.html" class="pagination-link" aria-label="Regression Main Concepts">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Regression Main Concepts</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.dev/HaykTarkhanyan/python_math_ml_course/blob/main/ml/01_Regression_Main_Concepts/Code/C1_Hyperparameter_Optimization.ipynb" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>